'use strict';
var debug = require('debug')('basedata');
var util = require('util');
var fs = require('fs');
var path = require('path');
var async = require('async');
var tool = require('leaptool');

module.exports = function(app, module_name) {

  var block = {};
  
  // throw error if no user is logged in, otherwise continue next
  block.ensureUserLogin = function(req, res, next) {
    var callback = arguments[3] || null;
    var loginUser = req.session && req.session.user;
    if (loginUser) {
      next();
    } else {
      var message = 'user is not logged in';
      app.cb(new Error(message), null, { message:message }, req, res, callback);
    }
  };
  
  return block;
};